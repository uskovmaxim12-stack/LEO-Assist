<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LEO ASSIST - –ü–∞–Ω–µ–ª—å —É—á–µ–Ω–∏–∫–∞</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-size: 24px;
            color: #00c6ff;
        }
        
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="loading-screen" class="loading">
        <div class="loading-content">
            <i class="fas fa-spinner fa-spin"></i>
            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞–Ω–µ–ª–∏...</p>
        </div>
    </div>
    
    <!-- –ß–∞—Å—Ç–∏—Ü—ã –Ω–∞ —Ñ–æ–Ω–µ -->
    <div id="particles-js"></div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (—Å–∫—Ä—ã—Ç –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏) -->
    <div id="dashboard-container" class="dashboard-container hidden">
        <!-- –°–∞–π–¥–±–∞—Ä -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="user-profile">
                    <div class="user-avatar" id="sidebar-avatar">–õ–£</div>
                    <div class="user-info">
                        <h3 id="sidebar-name">–£—á–µ–Ω–∏–∫ 7–ë</h3>
                        <span class="user-status online"></span>
                    </div>
                </div>
                
                <div class="user-stats">
                    <div class="stat">
                        <div class="stat-value" id="sidebar-points">0</div>
                        <div class="stat-label">–û—á–∫–∏</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="sidebar-level">1</div>
                        <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å</div>
                    </div>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <a href="#dashboard" class="nav-item active" onclick="switchSection('dashboard')">
                    <i class="fas fa-home"></i>
                    <span>–ì–ª–∞–≤–Ω–∞—è</span>
                </a>
                <a href="#schedule" class="nav-item" onclick="switchSection('schedule')">
                    <i class="fas fa-calendar-alt"></i>
                    <span>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</span>
                </a>
                <a href="#ai" class="nav-item" onclick="switchSection('ai')">
                    <i class="fas fa-robot"></i>
                    <span>AI –ü–æ–º–æ—â–Ω–∏–∫</span>
                </a>
                <a href="#games" class="nav-item" onclick="switchSection('games')">
                    <i class="fas fa-gamepad"></i>
                    <span>–ò–≥—Ä—ã</span>
                </a>
                <a href="#rating" class="nav-item" onclick="switchSection('rating')">
                    <i class="fas fa-trophy"></i>
                    <span>–†–µ–π—Ç–∏–Ω–≥</span>
                </a>
            </nav>
            
            <div class="sidebar-footer">
                <button class="btn-icon" onclick="refreshData()" title="–û–±–Ω–æ–≤–∏—Ç—å">
                    <i class="fas fa-sync-alt"></i>
                </button>
                <button class="btn-icon logout" onclick="logout()" title="–í—ã–π—Ç–∏">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </aside>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main class="main-content">
            <!-- –®–∞–ø–∫–∞ -->
            <header class="main-header">
                <div class="header-left">
                    <h1 id="page-title">–ì–ª–∞–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å</h1>
                    <p id="page-subtitle">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</p>
                </div>
                
                <div class="header-right">
                    <div class="datetime">
                        <div class="time" id="current-time">--:--</div>
                        <div class="date" id="current-date">-- --- ----</div>
                    </div>
                </div>
            </header>
            
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ -->
            <div class="content-area">
                <!-- –ì–ª–∞–≤–Ω–∞—è -->
                <section id="section-dashboard" class="content-section active">
                    <div class="welcome-card">
                        <h2>–ü—Ä–∏–≤–µ—Ç, <span id="welcome-name">–£—á–µ–Ω–∏–∫</span>! üëã</h2>
                        <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Leo Assistant - —Ç–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –≤ —É—á—ë–±–µ.</p>
                    </div>
                    
                    <div class="dashboard-grid">
                        <!-- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è -->
                        <div class="widget large">
                            <div class="widget-header">
                                <h3><i class="fas fa-calendar-day"></i> –°–µ–≥–æ–¥–Ω—è</h3>
                                <span id="today-date">–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫</span>
                            </div>
                            <div class="widget-body">
                                <div id="today-lessons">
                                    <div class="loading-lesson">
                                        <i class="fas fa-spinner fa-spin"></i>
                                        <span>–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è...</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- AI –ü–æ–º–æ—â–Ω–∏–∫ -->
                        <div class="widget medium">
                            <div class="widget-header">
                                <h3><i class="fas fa-robot"></i> AI –ü–æ–º–æ—â–Ω–∏–∫</h3>
                                <span class="ai-status online"></span>
                            </div>
                            <div class="widget-body">
                                <div class="ai-quick">
                                    <div class="ai-message">
                                        <div class="avatar">ü§ñ</div>
                                        <div class="message">
                                            <p>–ü—Ä–∏–≤–µ—Ç! –Ø –õ–µ–æ. –ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å:</p>
                                        </div>
                                    </div>
                                    
                                    <div class="ai-input">
                                        <input type="text" id="quick-question" placeholder="–°–ø—Ä–æ—Å–∏—Ç—å –æ...">
                                        <button onclick="askAI()">
                                            <i class="fas fa-paper-plane"></i>
                                        </button>
                                    </div>
                                    
                                    <div class="quick-questions">
                                        <button class="quick-q" onclick="setQuestion('–ö–∞–∫–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ?')">
                                            –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ
                                        </button>
                                        <button class="quick-q" onclick="setQuestion('–ß—Ç–æ –∑–∞–¥–∞–ª–∏?')">
                                            –î–æ–º–∞—à–Ω–µ–µ
                                        </button>
                                        <button class="quick-q" onclick="setQuestion('–ü–æ–º–æ—â—å —Å –∞–ª–≥–µ–±—Ä–æ–π')">
                                            –ê–ª–≥–µ–±—Ä–∞
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
                        <div class="widget small">
                            <div class="widget-header">
                                <h3><i class="fas fa-bolt"></i> –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                            </div>
                            <div class="widget-body">
                                <div class="quick-actions">
                                    <button class="quick-action" onclick="addTask()">
                                        <i class="fas fa-plus"></i>
                                        <span>–ó–∞–¥–∞—á–∞</span>
                                    </button>
                                    <button class="quick-action" onclick="switchSection('schedule')">
                                        <i class="fas fa-calendar"></i>
                                        <span>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</span>
                                    </button>
                                    <button class="quick-action" onclick="switchSection('games')">
                                        <i class="fas fa-gamepad"></i>
                                        <span>–ò–≥—Ä—ã</span>
                                    </button>
                                    <button class="quick-action" onclick="showNotes()">
                                        <i class="fas fa-sticky-note"></i>
                                        <span>–ó–∞–º–µ—Ç–∫–∏</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ -->
                <section id="section-schedule" class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-calendar-alt"></i> –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ 7–ë –∫–ª–∞—Å—Å–∞</h2>
                        <div class="week-selector">
                            <button onclick="prevWeek()"><i class="fas fa-chevron-left"></i></button>
                            <span id="week-display">–¢–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è</span>
                            <button onclick="nextWeek()"><i class="fas fa-chevron-right"></i></button>
                        </div>
                    </div>
                    
                    <div class="schedule-container" id="full-schedule">
                        <!-- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </div>
                </section>
                
                <!-- AI –ü–æ–º–æ—â–Ω–∏–∫ -->
                <section id="section-ai" class="content-section">
                    <div class="ai-container">
                        <div class="ai-header">
                            <div class="ai-avatar">
                                <div class="avatar-large">ü§ñ</div>
                                <div class="ai-info">
                                    <h3>Leo Assistant</h3>
                                    <span class="ai-status-text">Online</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="ai-chat">
                            <div class="chat-history" id="ai-chat-history">
                                <!-- –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ -->
                            </div>
                            
                            <div class="chat-input">
                                <textarea 
                                    id="ai-chat-input" 
                                    placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å..."
                                    rows="2"
                                ></textarea>
                                <button onclick="sendAI()">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- –ò–≥—Ä—ã -->
                <section id="section-games" class="content-section">
                    <div class="games-header">
                        <h2><i class="fas fa-gamepad"></i> –û–±—É—á–∞—é—â–∏–µ –∏–≥—Ä—ã</h2>
                        <p>–ò–≥—Ä–∞–π—Ç–µ –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—á–∫–∏!</p>
                    </div>
                    
                    <div class="games-grid" id="games-list">
                        <!-- –ò–≥—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </div>
                </section>
                
                <!-- –†–µ–π—Ç–∏–Ω–≥ -->
                <section id="section-rating" class="content-section">
                    <div class="rating-container">
                        <div class="rating-header">
                            <h2><i class="fas fa-trophy"></i> –†–µ–π—Ç–∏–Ω–≥ –∫–ª–∞—Å—Å–∞</h2>
                            <select id="rating-filter" onchange="updateRating()">
                                <option value="all">–í—Å–µ –≤—Ä–µ–º—è</option>
                                <option value="week">–ó–∞ –Ω–µ–¥–µ–ª—é</option>
                                <option value="month">–ó–∞ –º–µ—Å—è—Ü</option>
                            </select>
                        </div>
                        
                        <div class="rating-list" id="class-rating">
                            <!-- –†–µ–π—Ç–∏–Ω–≥ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>
    
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div class="notifications" id="notifications"></div>
    
    <!-- –°–∫—Ä–∏–ø—Ç—ã -->
    <script src="./js/particles.min.js"></script>
    <script>
        // ========== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==========
        let currentUser = null;
        let currentSection = 'dashboard';
        
        // ========== –§–£–ù–ö–¶–ò–ò –î–ê–®–ë–û–†–î–ê ==========
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        function initDashboard() {
            console.log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞—à–±–æ—Ä–¥–∞...');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ—Å—Å–∏—é
            const session = localStorage.getItem('leo_session');
            if (!session) {
                console.log('‚ùå –ù–µ—Ç —Å–µ—Å—Å–∏–∏, —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –≤—Ö–æ–¥');
                window.location.href = 'index.html';
                return;
            }
            
            try {
                currentUser = JSON.parse(session);
                console.log('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω:', currentUser);
                
                // –°–∫—Ä—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∞—à–±–æ—Ä–¥
                document.getElementById('loading-screen').classList.add('hidden');
                document.getElementById('dashboard-container').classList.remove('hidden');
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                loadUserData();
                loadSchedule();
                loadGames();
                loadRating();
                initAI();
                updateTime();
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
                setInterval(updateTime, 60000);
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–∞—Å—Ç–∏—Ü
                initParticles();
                
                console.log('‚úÖ –î–∞—à–±–æ—Ä–¥ –≥–æ—Ç–æ–≤!');
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞—à–±–æ—Ä–¥–∞:', error);
                logout();
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function loadUserData() {
            if (!currentUser) return;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –±–∞–∑—ã
            const users = JSON.parse(localStorage.getItem('leo_users') || '[]');
            const freshUser = users.find(u => u.id === currentUser.id);
            if (freshUser) {
                currentUser = freshUser;
                localStorage.setItem('leo_session', JSON.stringify(currentUser));
            }
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            document.getElementById('sidebar-avatar').textContent = currentUser.avatar || '–£–ß';
            document.getElementById('sidebar-name').textContent = currentUser.fullname;
            document.getElementById('sidebar-points').textContent = currentUser.points || 0;
            document.getElementById('sidebar-level').textContent = currentUser.level || 1;
            document.getElementById('welcome-name').textContent = currentUser.fullname.split(' ')[0];
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
        function loadSchedule() {
            const schedule = {
                monday: [
                    { time: "13:10-13:50", subject: "–ò—Å—Ç–æ—Ä–∏—è", room: "16 –ö–∞–±" },
                    { time: "14:00-14:40", subject: "–†–∞–∑–≥–æ–≤–æ—Ä—ã –æ –≤–∞–∂–Ω–æ–º", room: "21 –ö–∞–±" },
                    { time: "14:50-15:30", subject: "–ë–∏–æ–ª–æ–≥–∏—è", room: "21 –ö–∞–±" },
                    { time: "15:40-16:20", subject: "–†—É—Å—Å–∫–∏–π —è–∑—ã–∫", room: "32 –ö–∞–±" },
                    { time: "16:30-17:10", subject: "–¢—Ä—É–¥", room: "6 –ö–∞–±" },
                    { time: "17:15-17:55", subject: "–¢—Ä—É–¥", room: "6 –ö–∞–±" },
                    { time: "18:00-18:40", subject: "–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞", room: "32 –ö–∞–±" }
                ],
                tuesday: [
                    { time: "13:10-13:50", subject: "–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞-–ø–ª", room: "42 –ö–∞–±" },
                    { time: "14:00-14:40", subject: "–ò—Å—Ç–æ—Ä–∏—è", room: "16 –ö–∞–±" },
                    { time: "14:50-15:30", subject: "–ò–ó–û", room: "6 –ö–∞–±" },
                    { time: "15:40-16:20", subject: "–ê–ª–≥–µ–±—Ä–∞", room: "34 –ö–∞–±" },
                    { time: "16:30-17:10", subject: "–†—É—Å—Å–∫–∏–π —è–∑—ã–∫", room: "32 –ö–∞–±" },
                    { time: "17:15-17:55", subject: "–§–∏–∑-—Ä–∞", room: "–°–ó" },
                    { time: "18:00-18:40", subject: "–ì–µ–æ–º–µ—Ç—Ä–∏—è", room: "34 –ö–∞–±" }
                ],
                wednesday: [
                    { time: "13:10-13:50", subject: "–§–∏–∑–∏–∫–∞", room: "35 –ö–∞–±" },
                    { time: "14:00-14:40", subject: "–ò—Å—Ç–æ—Ä–∏—è", room: "16 –ö–∞–±" },
                    { time: "14:50-15:30", subject: "–§–∏–∑-—Ä–∞", room: "–°–ó" },
                    { time: "15:40-16:20", subject: "–†—É—Å—Å–∫–∏–π —è–∑—ã–∫", room: "32 –ö–∞–±" },
                    { time: "16:30-17:10", subject: "–§–∏–∑–∏–∫–∞", room: "35 –ö–∞–±" },
                    { time: "17:15-17:55", subject: "–ì–µ–æ–≥—Ä–∞—Ñ–∏—è", room: "22 –ö–∞–±" },
                    { time: "18:00-18:40", subject: "–†—É—Å—Å–∫–∏–π —è–∑—ã–∫-–ø–ª", room: "32 –ö–∞–±" }
                ],
                thursday: [
                    { time: "13:10-13:50", subject: "–ê–ª–≥–µ–±—Ä–∞", room: "34 –ö–∞–±" },
                    { time: "14:00-14:40", subject: "–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∏ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", room: "34 –ö–∞–±" },
                    { time: "14:50-15:30", subject: "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫", room: "12 –ö–∞–±" },
                    { time: "15:40-16:20", subject: "–ì–µ–æ–≥—Ä–∞—Ñ–∏—è", room: "22 –ö–∞–±" },
                    { time: "16:30-17:10", subject: "–†—É—Å—Å–∫–∏–π —è–∑—ã–∫", room: "32 –ö–∞–±" },
                    { time: "17:15-17:55", subject: "–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞", room: "32 –ö–∞–±" },
                    { time: "18:00-18:40", subject: "–§–∏–∑-—Ä–∞", room: "–°–ó" }
                ],
                friday: [
                    { time: "13:10-13:50", subject: "–ê–ª–≥–µ–±—Ä–∞", room: "34 –ö–∞–±" },
                    { time: "14:00-14:40", subject: "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫/–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞", room: "12 / 42" },
                    { time: "14:50-15:30", subject: "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫", room: "12 –ö–∞–±" },
                    { time: "15:40-16:20", subject: "–ì–µ–æ–º–µ—Ç—Ä–∏—è", room: "34 –ö–∞–±" },
                    { time: "16:30-17:10", subject: "–ë–∏–æ–ª–æ–≥–∏—è", room: "21 –ö–∞–±" },
                    { time: "17:15-17:55", subject: "–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞/–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫", room: "42 / 12" },
                    { time: "18:00-18:40", subject: "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞-–í–î", room: "34 –ö–∞–±" }
                ],
                saturday: [
                    { time: "12:20-13:00", subject: "–ú—É–∑—ã–∫–∞", room: "–ê–ó" },
                    { time: "13:10-13:50", subject: "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞-–ø–ª", room: "34 –ö–∞–±" },
                    { time: "14:00-14:40", subject: "–•–∏–º–∏—è", room: "33 –ö–∞–±" },
                    { time: "14:50-15:30", subject: "–§–∏–∑–∏–∫–∞", room: "35 –ö–∞–±" },
                    { time: "15:40-16:20", subject: "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞-–í–î", room: "34 –ö–∞–±" },
                    { time: "16:30-17:10", subject: "–§–∏–∑–∏–∫–∞-–ø–ª", room: "35 –ö–∞–±" }
                ]
            };
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–µ —É—Ä–æ–∫–∏
            const days = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
            const today = new Date().getDay();
            const todayKey = days[today];
            const todayLessons = schedule[todayKey] || [];
            
            const container = document.getElementById('today-lessons');
            if (todayLessons.length > 0) {
                let html = '';
                todayLessons.forEach(lesson => {
                    html += `
                        <div class="lesson-item">
                            <span class="lesson-time">${lesson.time}</span>
                            <span class="lesson-subject">${lesson.subject}</span>
                            <span class="lesson-room">${lesson.room}</span>
                        </div>
                    `;
                });
                container.innerHTML = html;
            } else {
                container.innerHTML = '<div class="no-lessons">–°–µ–≥–æ–¥–Ω—è –∑–∞–Ω—è—Ç–∏–π –Ω–µ—Ç</div>';
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞—Ç—É
            const dayNames = ['–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ', '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–í—Ç–æ—Ä–Ω–∏–∫', '–°—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä–≥', '–ü—è—Ç–Ω–∏—Ü–∞', '–°—É–±–±–æ—Ç–∞'];
            document.getElementById('today-date').textContent = dayNames[today];
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä
        function loadGames() {
            const games = [
                {
                    id: 1,
                    name: "–ê–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤",
                    description: "–†–µ—à–∞–π—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è 7 –∫–ª–∞—Å—Å–∞",
                    icon: "üßÆ",
                    subject: "–ê–ª–≥–µ–±—Ä–∞",
                    color: "#00c6ff"
                },
                {
                    id: 2,
                    name: "–ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π –≥–µ–Ω–∏–π",
                    description: "–ó–∞–¥–∞—á–∏ –ø–æ –≥–µ–æ–º–µ—Ç—Ä–∏–∏",
                    icon: "üìê",
                    subject: "–ì–µ–æ–º–µ—Ç—Ä–∏—è",
                    color: "#ff6b9d"
                },
                {
                    id: 3,
                    name: "–§–∏–∑–∏—á–µ—Å–∫–∏–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç",
                    description: "–ó–∞–¥–∞—á–∏ –ø–æ —Ñ–∏–∑–∏–∫–µ",
                    icon: "‚ö°",
                    subject: "–§–∏–∑–∏–∫–∞",
                    color: "#ffcc00"
                },
                {
                    id: 4,
                    name: "–•–∏–º–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–∫—Ü–∏—è",
                    description: "–£—Ä–∞–≤–Ω—è–π—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è",
                    icon: "üß™",
                    subject: "–•–∏–º–∏—è",
                    color: "#00ff88"
                }
            ];
            
            const container = document.getElementById('games-list');
            let html = '';
            
            games.forEach(game => {
                html += `
                    <div class="game-card" style="border-color: ${game.color}">
                        <div class="game-icon">${game.icon}</div>
                        <h3>${game.name}</h3>
                        <p>${game.description}</p>
                        <div class="game-meta">
                            <span class="game-subject">${game.subject}</span>
                        </div>
                        <button class="game-play" onclick="playGame(${game.id})">
                            <i class="fas fa-play"></i> –ò–≥—Ä–∞—Ç—å
                        </button>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞
        function loadRating() {
            const users = JSON.parse(localStorage.getItem('leo_users') || '[]');
            const students = users
                .filter(u => u.active && u.role === 'student')
                .sort((a, b) => (b.points || 0) - (a.points || 0))
                .slice(0, 10);
            
            const container = document.getElementById('class-rating');
            let html = '';
            
            if (students.length > 0) {
                students.forEach((student, index) => {
                    const isCurrent = student.id === currentUser.id;
                    const medal = index < 3 ? ['ü•á', 'ü•à', 'ü•â'][index] : `${index + 1}.`;
                    
                    html += `
                        <div class="rating-item ${isCurrent ? 'current' : ''}">
                            <span class="rank">${medal}</span>
                            <span class="avatar">${student.avatar}</span>
                            <span class="name">${student.fullname}</span>
                            <span class="points">${student.points || 0} –æ—á–∫–æ–≤</span>
                        </div>
                    `;
                });
            } else {
                html = '<div class="empty-rating">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ä–µ–π—Ç–∏–Ω–≥–µ</div>';
            }
            
            container.innerHTML = html;
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è AI
        function initAI() {
            // –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            addAIMessage("–ü—Ä–∏–≤–µ—Ç! –Ø –õ–µ–æ, –≤–∞—à –ø–æ–º–æ—â–Ω–∏–∫ –≤ —É—á—ë–±–µ. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?", 'ai');
        }
        
        // ========== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–π
        function switchSection(section) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
            document.querySelectorAll('.content-section').forEach(s => {
                s.classList.remove('active');
            });
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –∫–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            document.querySelectorAll('.nav-item').forEach(n => {
                n.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é
            document.getElementById(`section-${section}`).classList.add('active');
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            document.querySelector(`.nav-item[href="#${section}"]`).classList.add('active');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            const titles = {
                'dashboard': '–ì–ª–∞–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å',
                'schedule': '–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ',
                'ai': 'AI –ü–æ–º–æ—â–Ω–∏–∫',
                'games': '–û–±—É—á–∞—é—â–∏–µ –∏–≥—Ä—ã',
                'rating': '–†–µ–π—Ç–∏–Ω–≥ –∫–ª–∞—Å—Å–∞'
            };
            
            document.getElementById('page-title').textContent = titles[section] || section;
            currentSection = section;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
        function updateTime() {
            const now = new Date();
            
            // –í—Ä–µ–º—è
            document.getElementById('current-time').textContent = 
                now.toLocaleTimeString('ru-RU', {hour: '2-digit', minute:'2-digit'});
            
            // –î–∞—Ç–∞
            document.getElementById('current-date').textContent = 
                now.toLocaleDateString('ru-RU', {day: 'numeric', month: 'long', year: 'numeric'});
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        function refreshData() {
            showNotification('–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã', 'info');
            loadUserData();
            loadRating();
        }
        
        // –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
        function logout() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?')) {
                localStorage.removeItem('leo_session');
                window.location.href = 'index.html';
            }
        }
        
        // AI —Ñ—É–Ω–∫—Ü–∏–∏
        function setQuestion(question) {
            document.getElementById('quick-question').value = question;
        }
        
        function askAI() {
            const question = document.getElementById('quick-question').value;
            if (!question.trim()) return;
            
            addAIMessage(question, 'user');
            document.getElementById('quick-question').value = '';
            
            // –ò–º–∏—Ç–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ AI
            setTimeout(() => {
                const responses = [
                    "–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º—Å—è –≤–º–µ—Å—Ç–µ.",
                    "–Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Å —ç—Ç–∏–º. –ù—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏?",
                    "–≠—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –≤–æ–ø—Ä–æ—Å. –î–∞–≤–∞–π—Ç–µ —è –ø–æ–∏—â—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.",
                    "–ü–æ–Ω—è–ª –≤–∞—à –≤–æ–ø—Ä–æ—Å. –°–µ–π—á–∞—Å –ø–æ–¥–≥–æ—Ç–æ–≤–ª—é –æ—Ç–≤–µ—Ç."
                ];
                
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                addAIMessage(randomResponse, 'ai');
            }, 1000);
        }
        
        function sendAI() {
            const input = document.getElementById('ai-chat-input');
            const question = input.value.trim();
            
            if (!question) return;
            
            addAIMessage(question, 'user', 'ai-chat-history');
            input.value = '';
            
            // –ò–º–∏—Ç–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ AI
            setTimeout(() => {
                const responses = [
                    "–Ø –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª –≤–∞—à –≤–æ–ø—Ä–æ—Å. –í–æ—Ç —á—Ç–æ —è –º–æ–≥—É —Å–∫–∞–∑–∞—Ç—å...",
                    "–≠—Ç–æ —Ö–æ—Ä–æ—à–∏–π –≤–æ–ø—Ä–æ—Å –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è —Å —É—á–∏—Ç–µ–ª–µ–º.",
                    "–î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –ø–æ —á–∞—Å—Ç—è–º.",
                    "–Ø –Ω–∞—à–µ–ª –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –≤–∞—à–µ–º—É –≤–æ–ø—Ä–æ—Å—É."
                ];
                
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                addAIMessage(randomResponse, 'ai', 'ai-chat-history');
                
                // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–Ω–∏–∑
                const chat = document.getElementById('ai-chat-history');
                chat.scrollTop = chat.scrollHeight;
            }, 1500);
        }
        
        function addAIMessage(text, sender, containerId = 'ai-chat-history') {
            const container = document.getElementById(containerId);
            const message = document.createElement('div');
            
            message.className = `ai-message ${sender}`;
            message.innerHTML = `
                <div class="avatar">${sender === 'user' ? (currentUser?.avatar || '–£') : 'ü§ñ'}</div>
                <div class="message">
                    <p>${text}</p>
                    <span class="time">${new Date().toLocaleTimeString('ru-RU', {hour: '2-digit', minute:'2-digit'})}</span>
                </div>
            `;
            
            container.appendChild(message);
            container.scrollTop = container.scrollHeight;
        }
        
        // –ò–≥—Ä—ã
        function playGame(gameId) {
            showNotification('–ò–≥—Ä–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...', 'info');
            // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –∏–≥—Ä—ã
        }
        
        // –ó–∞–¥–∞—á–∏
        function addTask() {
            const task = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É:');
            if (task) {
                showNotification('–ó–∞–¥–∞—á–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞', 'success');
            }
        }
        
        function showNotes() {
            showNotification('–ó–∞–º–µ—Ç–∫–∏ –æ—Ç–∫—Ä–æ—é—Ç—Å—è —Å–∫–æ—Ä–æ', 'info');
        }
        
        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –Ω–µ–¥–µ–ª—è–º
        function prevWeek() {
            showNotification('–ü—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è', 'info');
        }
        
        function nextWeek() {
            showNotification('–°–ª–µ–¥—É—é—â–∞—è –Ω–µ–¥–µ–ª—è', 'info');
        }
        
        function updateRating() {
            showNotification('–†–µ–π—Ç–∏–Ω–≥ –æ–±–Ω–æ–≤–ª–µ–Ω', 'info');
            loadRating();
        }
        
        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notifications');
            const notification = document.createElement('div');
            
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            
            container.appendChild(notification);
            
            // –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        // –ß–∞—Å—Ç–∏—Ü—ã
        function initParticles() {
            if (typeof particlesJS !== 'undefined') {
                particlesJS('particles-js', {
                    particles: {
                        number: { value: 60, density: { enable: true, value_area: 800 } },
                        color: { value: ["#00c6ff", "#0072ff", "#ff6b9d"] },
                        shape: { type: "circle" },
                        opacity: { value: 0.3, random: true },
                        size: { value: 3, random: true },
                        line_linked: {
                            enable: true,
                            distance: 150,
                            color: "#00c6ff",
                            opacity: 0.2,
                            width: 1
                        },
                        move: {
                            enable: true,
                            speed: 1.5,
                            direction: "none",
                            random: true
                        }
                    }
                });
            }
        }
        
        // ========== –ó–ê–ü–£–°–ö –î–ê–®–ë–û–†–î–ê ==========
        document.addEventListener('DOMContentLoaded', initDashboard);
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        window.switchSection = switchSection;
        window.refreshData = refreshData;
        window.logout = logout;
        window.setQuestion = setQuestion;
        window.askAI = askAI;
        window.sendAI = sendAI;
        window.playGame = playGame;
        window.addTask = addTask;
        window.showNotes = showNotes;
        window.prevWeek = prevWeek;
        window.nextWeek = nextWeek;
        window.updateRating = updateRating;
    </script>
</body>
</html>
